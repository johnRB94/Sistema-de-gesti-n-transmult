<!--movimientos.html-->
<!DOCTYPE html>
<html
  lang="es"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
>
  <head>
    <meta charset="UTF-8" />
    <title>Registro de Entradas y Salidas</title>
    <link rel="stylesheet" th:href="@{/CSS/movimiento.css}" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT"
      crossorigin="anonymous"
    />
    <link
      rel="shortcut icon"
      th:href="@{/img/trasmult.png}"
      type="image/x-png"
    />
  </head>

  <body>
    <header class="text-white py-3">
      <div
        class="container d-flex flex-wrap align-items-center justify-content-between"
      >
        <div class="logo display-6 fw-bold">
          SISTEMA DE INVENTARIO - TRASMULT
        </div>
        <nav class="nav flex-column flex-sm-row text-center text-sm-start">
          <a class="nav-link text-white fw-bold px-3" th:href="@{/inicio}"
            >INICIO</a
          >
          <a class="nav-link text-white fw-bold px-3" th:href="@{/productos}"
            >PRODUCTOS</a
          >
          <a class="nav-link text-white fw-bold px-3" th:href="@{/movimientos}"
            >ENTRADAS/SALIDAS</a
          >

          <!-- Reportes solo visible para ADMIN y SUPERVISOR -->
          <th:block sec:authorize="hasRole('ADMIN') or hasRole('SUPERVISOR')">
            <a th:href="@{/reportes}">REPORTES</a>
          </th:block>

          <a class="nav-link text-white fw-bold px-3" th:href="@{/logout}"
            >SALIR</a
          >
        </nav>
      </div>
    </header>

    <main class="container-fluid py-4" style="max-width: 1600px">
      <h2 class="mb-4">Movimientos de Productos</h2>

      <!-- ðŸ” BUSCADOR POR FECHA -->
      <div class="card p-3 mb-4 shadow-sm">
        <h5 class="mb-3">Buscar movimientos por fecha</h5>
        <div class="row g-2 align-items-center">
          <div class="col-md-5">
            <input type="date" id="buscarFechaMov" class="form-control" />
          </div>
          <div class="col-md-3">
            <button
              class="btn btn-primary w-100"
              onclick="filtrarMovimientos()"
            >
              Buscar
            </button>
          </div>
          <div class="col-md-4 text-end">
            <button
              class="btn btn-secondary w-100"
              onclick="limpiarFiltroMovimientos()"
            >
              Limpiar Filtro
            </button>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-md-8 mb-4">
          <div class="table-responsive mb-4">
            <table
              class="table table-striped table-bordered w-100"
              id="tablaMovimientos"
            >
              <thead class="table-primary">
                <tr>
                  <th>FECHA</th>
                  <th>CÃ“DIGO</th>
                  <th>DESCRIPCIÃ“N</th>
                  <th>MARCA</th>
                  <th>UNIDAD DE MEDIDA</th>
                  <th>ENTRADA</th>
                  <th>SALIDA</th>
                  <th>ENTREGADO/RECEPCIONADO</th>
                </tr>
              </thead>

              <tbody id="tablaMovimientos">
                <tr th:each="movimiento : ${movimientos}">
                  <td th:text="${movimiento.fecha}">FECHA</td>
                  <td th:text="${movimiento.codigo}">CODIGO</td>
                  <td th:text="${movimiento.descripcion}">DESCRIPCION</td>
                  <td th:text="${movimiento.marca}">MARCA</td>
                  <td th:text="${movimiento.unidad}">UNIDAD</td>
                  <td th:text="${movimiento.entrada}">ENTRADA</td>
                  <td th:text="${movimiento.salida}">SALIDA</td>
                  <td th:text="${movimiento.responsable}">RESPONSABLE</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="col-md-4">
          <form id="formMovimiento">
            <div class="mb-3">
              <label for="fecha" class="form-label">Fecha:</label>
              <input
                type="date"
                id="fecha"
                class="form-control"
                name="fecha"
                required
              />
            </div>
            <div class="mb-3">
              <label for="codigoMov" class="form-label"
                >CÃ³digo del Producto:</label
              >
              <input
                type="text"
                id="codigoMov"
                class="form-control"
                name="codigo"
                placeholder="A001"
                required
                pattern="A\d{1,3}"
                title="Debe empezar con 'A' seguido de hasta 3 nÃºmeros (ej: A001, A012,A232)"
              />
            </div>
            <div class="mb-3">
              <label for="entrada" class="form-label">Entrada:</label>
              <input
                type="number"
                id="entrada"
                value="0"
                class="form-control"
                name="entrada"
              />
            </div>
            <div class="mb-3">
              <label for="salida" class="form-label">Salida:</label>
              <input
                type="number"
                id="salida"
                value="0"
                class="form-control"
                name="salida"
              />
            </div>
            <div class="mb-3">
              <label for="responsable" class="form-label"
                >Entregado/Recepcionado por:</label
              >
              <input
                type="text"
                id="responsable"
                class="form-control mayusculas"
                name="responsable"
                required
              />
            </div>
            <button type="submit" class="btn btn-success mt-3 btn-agregar">
              Registrar Movimiento
            </button>
          </form>
        </div>
      </div>
    </main>

    <footer>
      <p>&copy; 2025 TRASMULT.MALABRIGO E.I.R.L</p>
    </footer>

    <script th:src="@{/JS/registroSalidaEntrada.js}"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
